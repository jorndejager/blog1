class BlogPostsController < ApplicationController
    before_action :authenticate_user!, except:[:index, :show, :like, :unlike, :debug ]
    before_action :set_blog_post, except: [:index, :new, :create, :debug]


    def like
        @blog_post = BlogPost.find(params[:id])

        unless cookies[:like_blog_posts]
            cookies[:like_blog_posts] = []
        end

        unless cookies[:like_blog_posts].include?(@blog_post.id)
          @blog_post.increment!(:likes)
          cookies[:like_blog_posts] << @blog_post.id

          puts("toevoegin")
          puts(cookies[:like_blog_posts])

          flash[:notice] = 'Blog post liked.'
        else
          flash[:alert] = 'You have already liked this blog post.'
        end

        redirect_to @blog_post
      end

      def debug
            cookies[:jemoeder] = []

            cookies[:jemoeder] << 21
            cookies[:jemoeder] << 23

            if cookies[:jemoeder].include?(21)
                puts("Ja hoor");
            else
                puts("nee hoor");
            end


            puts(cookies[:jemoeder])
      end


      def unlike
        @blog_post = BlogPost.find(params[:id])

        puts("asdasas")
        puts(cookies[:like_blog_posts])

        if cookies[:like_blog_posts].include?(@blog_post.id)
          @blog_post.decrement!(:likes)
          cookies[:like_blog_posts].delete(@blog_post.id)

          flash[:notice] = 'Blog post unliked.'
        else
          flash[:alert] = 'You have not liked this blog post.'
        end

        redirect_to @blog_post
      end

    #def like
     #   @blog_post.increment!(:likes)
      #  redirect_to @blog_post
   # end

   # def unlike
    #    @blog_post.decrement!(:likes)
     #   redirect_to @blog_post
    #end



    def index
        @blog_posts = BlogPost.all
    end

    def show
    end

    def new
        @blog_post= BlogPost.new
    end

    def create
        @blog_post = BlogPost.new(blog_post_params)
        if @blog_post.save
            redirect_to @blog_post
        else
            render :new, status: :unprocessable_entity
        end
    end

    def edit
    end


    def update
        if @blog_post.update(blog_post_params)
            redirect_to @blog_post
        else
            render :edit, status: :unprocessable_entity

        end
    end


def destroy
    @blog_post.destroy
    redirect_to root_path
end


    private


    def blog_post_params
        params.require( :blog_post).permit(:title, :body)
    end

    def set_blog_post
        @blog_post = BlogPost.find(params[:id])
    rescue ActiveRecord::RecordNotFound
        redirect_to root_path
    end

    #def authenticate_user!
     #   redirect_to new_user_session_path, alert: "you must be signed in to continue." unless user_signed_in?
    #end

end
